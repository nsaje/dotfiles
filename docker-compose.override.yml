postgres:
    expose:
      - "5432"

# this is fake telegraf that only prints stats on stdout
telegraf:
    expose:
      - "8135/udp"

memcached:
    expose:
      - "11211"

einsstatic:
    hostname: einsstatic
    image: digitallyseamless/nodejs-bower-grunt
    ports:
      - "9999"
    volumes:
      - "./client/:/data/:ro"
    entrypoint: /bin/bash
    command: -c "npm prune && npm install; grunt dev"
    tty: true

eins:
    container_name: eins
    restart: always
    hostname: eins
    image: 569683728510.dkr.ecr.us-east-1.amazonaws.com/zemanta/z1
    ports:
      - "8000:8000"
    links:
      - "postgres:db"
      - "memcached:memcached"
      - "einsstatic"
      - "telegraf"
    volumes:
      - "./server/:/app/z1/"
      - ".:/src:ro"
    working_dir: /app/z1/
    entrypoint: /src/docker/entrypoint_dev.sh
    command: python manage.py runserver 0.0.0.0:8000
    tty: true
    stdin_open: true
