{% extends "base.html" %}

{% block head_extra %}
    <base href="/">

    <script>
        window.zOne = {
            whitelabel: null
        };

        {% if whitelabel %}
            window.zOne.whitelabel = {
                id: "{{ whitelabel }}",
                dashboardTitle: "{{ dashboardTitle }}",
                termsOfServiceUrl: "{{ termsOfServiceUrl }}",
                copyrightHolder: "{{ copyrightHolder }}",
                copyrightHolderUrl: "{{ copyrightHolderUrl }}",
            };
        {% endif %}
    </script>

    <link type="text/css" rel="stylesheet" href="{{ staticUrl }}/one/zemanta-one.lib.css" />

    {% if whitelabel %}
        <link type="text/css" rel="stylesheet" href="{{ staticUrl }}/one/zemanta-one-{{ whitelabel }}.css" />
    {% else %}
        <link type="text/css" rel="stylesheet" href="{{ staticUrl }}/one/zemanta-one.css" />
    {% endif %}

    {% if not debug %}
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-54L6ZFS');</script>
    {% endif %}
{% endblock %}

{% block content %}
    <zem-app-root>
        <div class="splash">
            <div class="zem-loader zem-loader__overlay">
                <div class="zem-loader__squares-container">
                    <div class="zem-loader__square zem-loader__square--1"></div>
                    <div class="zem-loader__square zem-loader__square--2"></div>
                    <div class="zem-loader__square zem-loader__square--3"></div>
                    <div class="zem-loader__square zem-loader__square--4"></div>
                    <div class="zem-loader__square zem-loader__square--5"></div>
                    <div class="zem-loader__square zem-loader__square--6"></div>
                    <div class="zem-loader__square zem-loader__square--7"></div>
                    <div class="zem-loader__square zem-loader__square--8"></div>
                    <div class="zem-loader__square zem-loader__square--9"></div>
                    <div class="zem-loader__square zem-loader__square--10"></div>
                    <div class="zem-loader__square zem-loader__square--11"></div>
                    <div class="zem-loader__square zem-loader__square--12"></div>
                    <div class="zem-loader__square zem-loader__square--13"></div>
                    <div class="zem-loader__square zem-loader__square--14"></div>
                    <div class="zem-loader__square zem-loader__square--15"></div>
                </div>
                <div class="zem-loader__description">Loading application</div>
            </div>
        </div>
    </zem-app-root>
{% endblock %}

{% block footer %}
    {% if not debug %}
        <!-- AdBlock test -->
        <script>
            var adblockTest = document.createElement('div');
            adblockTest.innerHTML = '&nbsp;';
            adblockTest.className = 'adsbox';
            document.body.appendChild(adblockTest);
            window.setTimeout(function() {
                if (adblockTest.offsetHeight === 0) {
                    alert("Zemanta One might not work as expected when an ad blocker is enabled in a web browser. Turn it off or add this web page's URL as an exception so you can continue working without any problems. After you turn off the ad blocker, you'll need to refresh your screen.");
                }
                adblockTest.remove();
            }, 100);
        </script>

        <!-- Mixpanel -->
        <script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);</script>
    {% endif %}

    <script type="text/javascript" src="{{ staticUrl }}/one/zemanta-one.polyfills.js"></script>
    <script type="text/javascript" src="{{ staticUrl }}/one/zemanta-one.lib.js"></script>
    <script type="text/javascript" src="{{ staticUrl }}/one/zemanta-one.js"></script>
{% endblock %}
