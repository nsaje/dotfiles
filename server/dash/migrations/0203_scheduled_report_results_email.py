# -*- coding: utf-8 -*-
# Generated by Django 1.9.5 on 2016-11-30 15:40
from __future__ import unicode_literals

from django.db import migrations
from dash.constants import EmailTemplateType


def load_data(apps, schema_editor):
    EmailTemplate = apps.get_model('dash', 'EmailTemplate')

    try:
        template = EmailTemplate.objects.get(template_type=EmailTemplateType.ASYNC_SCHEDULED_REPORT_RESULTS)
    except EmailTemplate.DoesNotExist:
        template = EmailTemplate(subject='Zemanta Scheduled Report: {report_name}', template_type=EmailTemplateType.ASYNC_SCHEDULED_REPORT_RESULTS)

    template.body = u'''Hi,

Your {frequency} report {report_name} is ready for download here:
{link_url}

Report settings

Account: {account_name}
Campaign: {campaign_name}
Ad Group: {ad_group_name}
Date range: {start_date} - {end_date}
View: {tab_name}
Breakdowns: {breakdown}
Filters: {filters}
Totals included: {include_totals}
Columns: {columns}

Note: Report will be available for download until {expiry_date}. You can cancel your scheduled report here: {cancel_url}

Yours truly,
Zemanta
    '''
    template.save()


class Migration(migrations.Migration):

    dependencies = [
        ('dash', '0202_auto_20170414_0955'),
    ]

    operations = [
        migrations.RunPython(load_data)
    ]
