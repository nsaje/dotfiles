<div class="page page-ad-group-publishers">
    <div class="section">
        <div class="graph-infobox-parent" ng-class="{'graph-collapsed': !graphVisible}">
            <div class="graph-infobox-row">
                <div class="graph-container">
                    <zem-chart zem-data="chartData" zem-metric1="chartMetric1" zem-metric2="chartMetric2" zem-metric-options="chartMetricOptions" zem-min-date="dateRange.startDate" zem-max-date="dateRange.endDate" zem-on-remove="selectedSourceRemoved(id)" local-storage-prefix="localStoragePrefix"></zem-chart>
                </div>
                <div class="infobox-container">
                    <zem-infobox class="infobox-wrapper" header="infoboxHeader" basic-settings="infoboxBasicSettings" performance-settings="infoboxPerformanceSettings" link-to="infoboxLinkTo" state-id="$state.params.id"></zem-infobox>
                </div>
            </div>
        </div>
    </div>
    <div class="section table-ad-group-sources" ng-if="!hasPermission('zemauth.can_access_table_breakdowns_feature_on_ad_group_level_publishers')">
        <div class="button-bar">
            <div class="button-bar-item">
                <div ng-show="hasPermission('zemauth.can_modify_publisher_blacklist_status')" style="display:inline;">
                    <zem-internal-feature ng-if="isPermissionInternal('zemauth.can_modify_publisher_blacklist_status')" popover-placement="bottom"></zem-internal-feature>
                    <zem-dropdown
                        zem-placeholder="Manage Blacklist"
                        zem-on-select="executeBulkAction(selected)"
                        zem-disabled-title="At least one Publisher has to be selected before using Manage Blacklist and all selected publishers need to be enabled."
                        zem-check-disabled="!isAnythingSelected()"
                        zem-dropdown-options="bulkBlacklistActions"
                        zem-dropdown-css-class="publishers-blacklist-bigdrop"
                        zem-css-class="show-rows"></zem-dropdown>
                </div>
            </div>

            <div class="button-bar-item">
                <div ng-show="hasPermission('zemauth.can_modify_publisher_blacklist_status')" style="display:inline;">
                    <zem-internal-feature ng-if="isPermissionInternal('zemauth.can_modify_publisher_blacklist_status')" popover-placement="bottom"></zem-internal-feature>
                    <zem-dropdown
                        zem-placeholder="Manage Re-enable"
                        zem-on-select="executeBulkAction(selected)"
                        zem-disabled-title="At least one Publisher has to be selected before using Manage Re-enable and all selected publishers need to be blacklisted."
                        zem-check-disabled="!isAnythingSelected()"
                        zem-dropdown-options="bulkEnableActions"
                        zem-dropdown-css-class="publishers-blacklist-bigdrop"
                        zem-css-class="show-rows"></zem-dropdown>

                    <span ng-show="isSyncInProgress">
                        <a id="resync-loader" popover="Synchronization of blacklisted publishers is currently in progress, and may take a few minutes. You can continue using the dashboard in the meantime." popover-append-to-body="true" popover-trigger="mouseenter" popover-placement="left"><div class="loader"></div></a>
                    </span>
                </div>
            </div>

            <zem-custom-table-cols class="pull-right" columns="columns" categories="columnCategories" local-storage-prefix="localStoragePrefix"></zem-custom-table-cols>
            <div class="clearfix"></div>
        </div>

        <zem-table zem-table-columns="columns" zem-table-rows="rows" zem-table-total-row="totals" zem-table-notifications="notifications" zem-table-show-loader="loadRequestInProgress" zem-table-order="order" zem-table-order-callback="orderTableData(order)" zem-table-data-status="dataStatus"></zem-table>

        <div class="table-footnotes">
            <div>* The reporting data is an estimate, and the final amount will be reflected on your invoice.</div>
            <div>* All times are in Eastern Standard Time (EST).</div>
        </div>

        <div class="pagination" ng-show="rows.length">
            <span>Go to page</span>
            <form ng-submit="loadPage()">
                <input class="page-num form-control" type="number" min="1" max="{{ pagination.numPages }}" ng-model="pagination.currentPage">
            </form>

            <span>Show rows</span>
            <zem-paging-dropdown class="show-rows" selection="selection"></zem-paging-dropdown>
            <div ng-disabled="pagination.currentPage == 1" class="btn btn-default" ng-click="loadPage(1)"><img ng-src="{{ config.static_url }}/one/img/arrow-first.svg"></div>
            <div ng-disabled="pagination.currentPage == 1" class="btn btn-default" ng-click="loadPage(pagination.currentPage - 1)"><img ng-src="{{ config.static_url }}/one/img/arrow-prev.svg"></div>
            <span class="current-rows">{{ pagination.startIndex}} - {{ pagination.endIndex }} of {{ pagination.count }}</span>
            <div ng-disabled="pagination.currentPage == pagination.numPages" class="btn btn-default" ng-click="loadPage(pagination.currentPage + 1)"><img ng-src="{{ config.static_url }}/one/img/arrow-next.svg"></div>
            <div ng-disabled="pagination.currentPage == pagination.numPages" class="btn btn-default" ng-click="loadPage(pagination.numPages)"><img ng-src="{{ config.static_url }}/one/img/arrow-last.svg"></div>
        </div>


    </div>

    <div class="section zem-internal-feature-container" ng-if="hasPermission('zemauth.can_access_table_breakdowns_feature_on_ad_group_level_publishers')">
        <zem-internal-feature ng-if="isPermissionInternal('zemauth.can_access_table_breakdowns_feature_on_ad_group_level_publishers')"></zem-internal-feature>

        <div class="button-bar" ng-if="grid.api">
            <zem-grid-bulk-publishers-actions api="grid.api"></zem-grid-bulk-publishers-actions>
            <zem-grid-column-selector api="grid.api" class="pull-right"></zem-grid-column-selector>
            <zem-grid-breakdown-selector api="grid.api" class="pull-right"></zem-grid-breakdown-selector>
        </div>

        <zem-grid-integration
                api="grid.api"
                options="grid.options"

                level="grid.level"
                breakdown="grid.breakdown"
                entity-id="grid.entityId"

                date-range="dateRange"
                selection="selection"
                selection-callback="updateSelectedRowsData"

                zem-has-permission="hasPermission"
                zem-is-permission-internal="isPermissionInternal">
        </zem-grid-integration>
    </div>
</div>
