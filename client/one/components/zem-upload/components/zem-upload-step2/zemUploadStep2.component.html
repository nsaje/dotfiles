<div>
    <div class="modal__body content-upload__contentad-picker" ng-class="{'content-upload__contentad-picker--editing': !!ctrl.editFormApi.selectedId}">
        <div class="clearfix"></div>
        <div class="content-upload__batch-name-container" ng-if="!ctrl.isEdit">
            <span class="content-upload__batch-name">Batch name:</span>
            <span class="content-upload__batch-title" ng-show="!ctrl.batchNameEdit">{{ ctrl.formData.batchName }}</span>
            <input class="input-text" type="text" ng-show="ctrl.batchNameEdit" ng-model="ctrl.formData.batchName"
                   id="batch-name-input" ng-focus="ctrl.clearBatchNameErrors()" ng-class="{'form--error': ctrl.saveErrors.batchName}"/>
            <a href class="button button--small button--with-icon edit-icon" ng-click="ctrl.toggleBatchNameEdit($event)"
               ng-if="!ctrl.batchNameEdit">Edit batch name</a>
            <a href class="button button--small button--with-icon check-icon" ng-click="ctrl.toggleBatchNameEdit($event)"
               ng-if="ctrl.batchNameEdit">Save</a>
        </div>
        <div class="content-upload__batch-name-container" ng-if="ctrl.isEdit">
            <span class="content-upload__batch-title">You're editing:</span>
        </div>
        <div class="content-upload__ads-container custom-scroller">
            <table class="table content-upload__ads-table">
                <tr ng-repeat="candidate in ctrl.candidates" ng-class="{'content-upload__selected-ad': candidate.id === ctrl.editFormApi.selectedId}" ng-click="ctrl.editFormApi.open(candidate)">
                    <td class="content-upload__ad-status" ng-class="{
                        'content-upload__ad-status--loading': ctrl.getStatus(candidate) === 'loading',
                        'content-upload__ad-status--ok': ctrl.getStatus(candidate) === 'ok',
                        'content-upload__ad-status--error': ctrl.getStatus(candidate) === 'errors'
                    }">
                    </td>
                    <td class="content-upload__ad-image-container">
                        <img class="content-upload__ad-image" ng-if="candidate.hostedImageUrl || candidate.imageUrl" ng-src="{{candidate.hostedImageUrl}}" />
                    </td>
                    <td class="content-upload__ad-title">
                        {{ candidate.title }}
                        <span ng-if="!candidate.title">Content ad title</span>
                    </td>
                    <td class="content-upload__ad-link">
                        {{ candidate.url }}
                    </td>
                    <td>
                        <div ng-if="ctrl.getContentErrorsMsg(candidate)" class="content-upload__ad-error content-upload__ad-error--content">
                            {{ ctrl.getContentErrorsMsg(candidate) }}
                        </div>
                        <div ng-if="ctrl.getImageErrorsMsg(candidate)" class="content-upload__ad-error content-upload__ad-error--image">
                            {{ ctrl.getImageErrorsMsg(candidate) }}
                        </div>
                    </td>
                    <td class="buttons-panel content-upload__ad-action-buttons">
                        <div class="message message--error" ng-if="candidate.removeRequestFailed">
                            Something went wrong. Please try again.
                        </div>
                        <div class="loader" ng-if="candidate.removeRequestInProgress"></div>
                        <a href ng-click="ctrl.editFormApi.open(candidate)" class="button button--small button--with-icon edit-icon" ng-disabled="candidate.removeRequestInProgress">Edit</a>
                        <a href ng-click="ctrl.removeCandidate(candidate, $event)" class="button button--small button--with-icon remove-icon" ng-disabled="candidate.removeRequestInProgress" ng-if="!ctrl.isEdit">Remove</a>
                    </td>
                </tr>
            </table>

            <div class="buttons-panel">
                <button type="button" class="button button--highlight button--with-icon add-icon"
                    ng-click="ctrl.addCandidate()" ng-disabled="ctrl.addCandidateRequestInProgress" ng-if="!ctrl.isEdit">
                    Add new
                </button>
                <button type="button" class="button button--with-icon download-icon" ng-click="ctrl.download()">
                    Download Ads Snapshot
                </button>
                <div class="loader" ng-if="ctrl.addCandidateRequestInProgress"></div>
                <div class="message message--error" ng-if="ctrl.addCandidateRequestFailed">Something went wrong. Please try again.</div>
            </div>
        </div>

        <zem-upload-edit-form endpoint="ctrl.endpoint" api="ctrl.editFormApi" update-callback="ctrl.updateCandidateCallback" refresh-callback="ctrl.refreshCandidatesCallback" batch-id="ctrl.batchId" is-edit="ctrl.isEdit"></zem-upload-edit-form>
        <div class="clear"></div>
    </div>
    <div class="modal__footer buttons-panel">
        <button type="button" class="button button--highlight button--with-icon check-icon" ng-click="ctrl.save()" ng-disabled="ctrl.isSaveDisabled()">
            <span ng-if="!ctrl.isEdit">Upload</span>
            <span ng-if="ctrl.isEdit">Save</span>
        </button>
        <button type="button" class="button button--outline" ng-click="ctrl.cancel()">Cancel</button>
        <div class="loader" ng-if="ctrl.isLoading()"></div>
        <div class="message message--error" ng-if="ctrl.getSaveErrorMsg()">{{ ctrl.getSaveErrorMsg() }}</div>
    </div>
</div>
