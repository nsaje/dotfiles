<div class="modal__header">
    <div class="modal__title">Export Report</div>
</div>
<div class="modal__body">
    <div class="form">
        <div class="form__text">
            <div class="form__title">You are downloading a report with the following settings:</div>
        </div>
        <div class="form__group">
            <label class="form__label">Date range:</label>
            <div class="form__information">{{ $ctrl.dateRange.startDate.format('ll') }} - {{ $ctrl.dateRange.endDate.format('ll') }}</div>
        </div>
        <div class="form__group">
            <label class="form__label">View:</label>
            <div class="form__information">
                {{ $ctrl.resolve.tab.name }}
            </div>
        </div>
        <div class="form__group" ng-if="$ctrl.breakdown.length > 0">
            <label class="form__label">Breakdowns:</label>
            <div class="form__information">
                <span ng-repeat="dimension in $ctrl.breakdown" class="tag">{{ dimension.name }}</span>
            </div>
        </div>
        <div class="form__group">
            <label class="form__label">Columns:</label>
            <div class="form__information">
                <span ng-repeat="field in $ctrl.shownSelectedFields" class="tag">{{ field }}</span>
                <a class="tag tag--show-more" ng-click="$ctrl.showAllSelectedFields()"
                   ng-if="$ctrl.shownSelectedFields.length < $ctrl.selectedFields.length">...</a>
            </div>
        </div>
        <div class="form__group" ng-if="$ctrl.appliedFilterConditions.length">
            <label class="form__label">Filters:</label>
            <div class="form__information">
                <span ng-repeat="condition in $ctrl.shownAppliedFilterConditions" class="tag">{{condition.text}}</span>
                <a class="tag tag--show-more" ng-click="$ctrl.showAllAppliedFilters()"
                   ng-if="$ctrl.shownAppliedFilterConditions.length < $ctrl.appliedFilterConditions.length">...</a>
            </div>
        </div>
        <div class="form__group">
            <zem-internal-feature ng-if="$ctrl.isPermissionInternal('zemauth.can_include_totals_in_reports')" popover-placement="right"></zem-internal-feature>
            <label class="form__label" for="include-totals-checkbox">Include totals</label>
            <input id="include-totals-checkbox" type="checkbox" ng-model="$ctrl.includeTotals" class="form__input--text">
        </div>
        <hr>
        <div class="form__group">
            <label class="form__label" for="recipients">Report will be sent to:</label>
            <div class="form__information" id="recipients">
                {{ $ctrl.user.email }}
            </div>
        </div>
        <div class="form__group">
            <label class="form__label">Add more recipients:</label>
            <textarea class="form__textarea" ng-class="{'form__textarea--error': $ctrl.errors.details.options.recipients.length > 0}" ng-model="$ctrl.recipients" placeholder="Comma-separated list of recipient email addresses"></textarea>
            <div ng-repeat="error in $ctrl.errors.details.options.recipients" class="message message--error" for="recipients">{{ error }}</div>
        </div>
    </div>
</div>
<div class="modal__footer buttons-panel">
    <button type="submit" class="button button--highlight button--with-icon button--send-icon" ng-click="$ctrl.startReport()" ng-show="!$ctrl.jobPosted" ng-disabled="$ctrl.jobPostingInProgress">Send</button>
    <button type="button" class="button button--outline" ng-click="$ctrl.close()" ng-show="!$ctrl.jobPosted">Cancel</button>
    <button type="button" class="button button--outline" ng-click="$ctrl.close()" ng-show="$ctrl.jobPosted">Close</button>
    <div class="loader" ng-show="$ctrl.jobPostingInProgress"></div>
    <span ng-show="$ctrl.jobPosted">Requested report will be sent to your inbox shortly.</span>
    <span class="message message--success" ng-show="$ctrl.jobPosted && $ctrl.jobPostedSuccessfully">Requested report will be sent to your inbox shortly.</span>
</div>
