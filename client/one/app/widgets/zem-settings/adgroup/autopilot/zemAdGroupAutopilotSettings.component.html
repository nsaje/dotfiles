<div class="zem-settings-component__container" ng-if="$ctrl.hasPermission('zemauth.can_set_adgroup_to_auto_pilot')">
    <zem-internal-feature ng-if="$ctrl.isPermissionInternal('zemauth.can_set_adgroup_to_auto_pilot')" popover-placement="right"></zem-internal-feature>
    <h2>Autopilot</h2>
    <div class="description">Bids and Daily Spend Caps Automation Settings.</div>
    <div class="col-xs-12 alert alert-warning form-alert-box" ng-if="$ctrl.isInLanding()">
        <div class="form-alert-exclamation">
            <img class="warning-icon" ng-src="{{ $ctrl.config.static_url }}/one/img/notification-warning.svg"></img>
        </div>
        <div class="form-alert-body">Autopilot is automatically enabled because the campaign is in landing mode. </div>
    </div>
    <div class="form-group">
        <div class="radio" ng-repeat='autopilotState in $ctrl.options.adGroupSettingsAutopilotStates'>
            <label>
                <input type="radio" ng-model="$ctrl.entity.settings.autopilotState" ng-value="autopilotState.value" ng-disabled="$ctrl.isInLanding()"> {{ autopilotState.name }} <zem-help-popover content="{{autopilotState.help}}" placement="right"></zem-help-popover>
            </label>

            <div ng-if="autopilotState.value === $ctrl.entity.settings.autopilotState">
                <div ng-if="autopilotState.value === $ctrl.constants.adGroupSettingsAutopilotState.INACTIVE &&  $ctrl.hasPermission('zemauth.can_see_rtb_sources_as_one')">
                    <div class="settings-option-group">
                        <div class="settings-option-group__header">
							<zem-internal-feature ng-if="$ctrl.isPermissionInternal('zemauth.can_see_rtb_sources_as_one')" popover-placement="right"></zem-internal-feature>
                            <span> Manage Daily Spend Caps of RTB sources: </span>
                        </div>
                        <div class="settings-option-group__control">
                            <label> <input type="radio" class="settings-option-group__control" ng-model="$ctrl.entity.settings.b1SourcesGroupEnabled" ng-value="false"> Separately</label>
                            <zem-help-popover content="Set Daily Spend Cap for each of the RTB sources." placement="right"></zem-help-popover>
                        </div>
                        <div class="settings-option-group__control">
                            <label> <input type="radio" class="settings-option-group__control" ng-model="$ctrl.entity.settings.b1SourcesGroupEnabled" ng-value="true"> As one</label>
                            <zem-help-popover content="Set one Daily Spend Cap for all RTB sources together." placement="right"></zem-help-popover>
                        </div>
                    </div>
                </div>
                <div ng-if="autopilotState.value === $ctrl.constants.adGroupSettingsAutopilotState.ACTIVE_CPC_BUDGET">
                    <div class="daily-spend-caps clearfix" ng-class="{'has-error': !!$ctrl.errors.autopilotBudget}">
                        <label for="autopilot-budget" class="col-xs-4 control-label">
                        Ad Group's Daily Spend Cap
                        <zem-help-popover content="Amount of budget Autopilot can operate with on this Ad Group every day." placement="top"></zem-help-popover>
                    </label>
                        <div class="col-xs-2">
                            <div class="form__prefixed-field">
                                <span class="form__field-prefix">$</span>
                                <input id="autopilot-budget" type="text" class="form__input-text" ng-model="$ctrl.entity.settings.autopilotBudget" fraction-size="0"
                                    zem-currency-input ng-disabled="$ctrl.isInLanding()">
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <label ng-repeat="error in $ctrl.errors.autopilotBudget" class="control-label error" for="autopilot-budget">{{ error }}</label>
                        </div>
                    </div>

                    <div class="daily-spend-caps">
                        <div class="col-xs-12">
                            Autopilot will optimize media sources' daily spend caps for <b>{{$ctrl.getBudgetAutopilotOptimizationGoalText()}}</b>
                            and try to hit the ad group's daily spend cap. To change optimization objective please change
                            Primary Campaign Goal in Campaign Settings.<br/>
                            <i>{{$ctrl.getBudgetAutopilotOptimizationCPAGoalText()}}</i>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <br/>
        <label class="col-xs-12 error" ng-repeat="error in $ctrl.errors.autopilotState" class="control-label error">{{ error }}</label>
    </div>
</div>
