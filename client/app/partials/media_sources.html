<div class="page page-media-sources">
    <div class="section" ng-class="{'height-hidden': !isChartShown}">
        <zem-chart zem-data="chartData" zem-metric1="chartMetric1" zem-metric2="chartMetric2" zem-metric-options="chartMetricOptions" zem-goal-metrics="chartGoalMetrics" zem-min-date="dateRange.startDate" zem-max-date="dateRange.endDate" zem-on-remove="selectedSourceRemoved(id)"></zem-chart>
    </div>

    <div class="section table-sources">
        <div class="button-bar">
            <zem-custom-table-cols class="pull-right" columns="columns" categories="columnCategories"></zem-custom-table-cols>

            <a id="chart-btn" ng-attr-title="{{ chartBtnTitle }}" class="btn btn-default pull-right" ng-click="toggleChart()"><img ng-src="{{ config.static_url }}/img/chart.svg"></a>

            <span ng-switch="isSyncInProgress">
                <span ng-switch-when="false">
                    <a ng-click="triggerSync()" id="resync-btn" class="btn btn-default pull-right" title="Sync reporting metrics"><img ng-src="{{ config.static_url }}/img/refresh.svg"></a>
                </span>
                <span ng-switch-when="true">
                    <a id="resync-loader" class="btn btn-default pull-right"><div class="loader"></div></a>
                </span>
            </span>

            <div class="clearfix"></div>
        </div>

        <alert type="info" class="alert-sync" ng-show="sourcesWaiting">
            We are adding the following media source(s): {{sourcesWaiting.join(', ')}}. This may take some time.
        </alert>
        <alert type="info" class="alert-sync" ng-show="isSyncRecent === false">
            We are experiencing a delay synchronizing reporting metrics. <span ng-if="!!lastSyncDate">the last successful sync took place {{ lastSyncDate.fromNow() }}.</span> 
            If you have any questions please contact us at <a href="mailto:help@zemanta.com">help@zemanta.com</a>.
        </alert>

        <zem-table zem-table-columns="columns" zem-table-rows="rows" zem-table-total-row="totals" zem-table-show-loader="loadRequestInProgress" zem-table-order="order" zem-table-order-callback="orderTableData(order)"></zem-table>

        <div class="last-sync">
            <span ng-switch="lastSyncDate">
                <span ng-switch-when="null">
                    * Reporting metrics haven't been synced yet.
                </span>
                <span ng-switch-default>
                    * Reporting metrics synced {{Â lastSyncDate.fromNow() }}. Managed service fee not included. The reporting data is an estimate, and the final amount will be reflected on your invoice.
                </span>
            </span>
        </div>
        <div class="incomplete-postclick">
            <span>
                * Postclick metrics might not reflect all the traffic that was sent.
            </span>
        </div>
    </div>
</div>
